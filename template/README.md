# Multimodule Template

[][TODO пока здесь]
Пример мультимодульного приложения использующего архитектуру приложения студии.
Служит для инициализации новых приложений.

## Инициализация проекта

В студии используется многомодульная архитектура проектов. Шаблон такого проекта
представлен модулем [template-multimodule](../template-multimodule/README.md).

В этом модуле содержится минимальная конфигурация приложения.

## Многомодульность

Многомодульное приложение обладает следующими преимуществами:
 - скорость сборки
 - паралельная сборка модулей
 - изоляция слоев

В студийной архитектуре выделяем следующие модули:
 -  [app-injector](#app-injector) - основной модуль приложения(точка входа). Знает обо всех модулях и
   является **единственным модулем с даггер зависимостями**. От него не зависит ни один другой модуль,
   он же зависит от всех.
 - [domain](#domain) - слой **Domain**. Содержит все ,
   что касается доменной области( модели данных).
 - [base](#base) - базовый модуль. Здесь объявляются зависимости необходимые во всех других модулях
   (через api). Также содержит базовые сущности , использующиеся как в i-, так в f-модулях.
 - [base-ui](#base-ui) - базовый слой для модулей фич и вообще пользовательских представлений.
   Зависит от base.

 - f-*name* - feature-модули. Модули, в которых ведется разработка конкретной фичи.
   Это может быть несколько экранов с одной семантикой (например авторизация), может быть один большой экран со сложной логикой.
   **Не зависят друг от друга!!!**
 - cf-*name* - common-feature-модули. Модули c фичами, которые переиспользуются в других фичах.
   **Не зависят друг от друга!!!**
 - i-*name* - модули-интеракторы. Данные модули принадлежат слою **Interactor**.
   Могут выполнять конкретный UseCase, могут содержать несколько интеракторов.
   **Могут зависеть друг от друга.**


При таком разбиении изменение одного фича-модуля влекут процесс сборки
только в нем и в app-injector.

## App-injector

Данный модуль является корневым модулем проекта. Все остальные модули являются библиотечными.
Особенность данного модуля - знать обо всех других модулях и иметь даггер зависимости.
(Только в этом модуле подключается *annotatiоnProccesor* из-за этого становиться возсожной
инкоементальная сборка других модулей -> ускорение сборки).

Модуль может содержать пакеты , принадлежащие слоям и interactor и ui.
Также содержит сам класс приложения App (наследуется от CoreApp или его наследников).

При инициализации приложения необходимо сконфигурировать Dagger-модули и компоненты.
Пример конфигурации можно посмотреть в шаблоне.

**!!! Важно !!!**
Для того , чтобы конфигураторы экранов были доступны в модулях фич создается object
ScreenConfiguratorStorage.
```kotlin

object ScreenConfiguratorStorage {

    val activityScreenConfiguratorMap = HashMap<KClass<*>, (intent: Intent) -> ActivityScreenConfigurator>()
            .apply {
                put(MainActivityView::class, { MainScreenConfigurator(it) })
            }

    val activityConfiguratorMap = HashMap<KClass<*>, (intent: Intent) -> ActivityConfigurator>()
            .apply {
            }

    val fragmentScreenConfiguratorMap = HashMap<KClass<*>, (args: Bundle) -> FragmentScreenConfigurator>()
            .apply {

            }

    val dialogScreenConfiguratorMap= HashMap<KClass<*>, (args: Bundle) -> DialogScreenConfigurator>()
            .apply {

            }

    val widgetScreenConfiguratorMap = HashMap<KClass<*>, () -> WidgetScreenConfigurator>()
            .apply {
            }
}

```

Для обеспечения навигации создается object RouteConfiguratorStorage(todo добавить)

## domain

Модуль самого нижнего уровня - от него зависят все остальные модули.
Содержит чаще всего модели данных.
Полностью соответсвует слою Domain.

## Base

Модуль , содержащий базовые сущности необходимые для работы i-модулей:
* CallAdapterFactory
* типы ошибок

Зависит от модуля domain.
В данном модуле происходит подключение библиотек необходимых по всему приложению,
так как именно от него зависят остальные модули.
Подключение зависимостей происходит через api.
```groovy
api "ru.surfstudio.android:animations:$surfCoreVersionName"
```

api - передает зависимости в дальнейшие модули.

Конфигурация модулей AndroidStandard происходиьт также здесь.

Модули рекомендовуемые к подключению: [здесь](../docs/modules.md)

## base-ui

Базовый модуль ui слоя. Содержит переиспользуемые виджеты, контроллеры, и тд.
Содержит базовые обработчики ошибок.

**!! Важно!! **
Содержит ComponentProvider - сущность , которая будет поставлять компоненты на экраны.
Инициализация его свойств проиcходит в App.




 
