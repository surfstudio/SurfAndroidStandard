[Главная](../main.md)

[TOC]

# Кастомные вью

[Официальная документация][docs]

[Простой пример реализации][ex]

[Подробная презентация][presentation]

### Когда создавать

* Нарушается принцип DRY в UI. Сочетание элементов используется в нескольких местах.
* Расширение поведения имеющихся компонент.
* Разбиения существующих layout для уменьшения сложности кода.
* Отображение объекта из слоя model или другого сложного объекта.

В отличии от layout содержит логику отображения (изменяемые состояния,
логика заполнения). Если есть возможность обойтись одним layout c последующим
использованием <include> ей нужно воспользоваться.

### Принципы построения custom view

- Максимально декларативно -  стараться как можно больше кода, связанного
с внешним видом отобразить в xml файлах верстки, а не в файле класса view.

- Использование атрибутов - помогает легче добиться успеха с предыдущим пунктом

- Должна полноценно отображаться в редакторе Android Studio.
Этому способствует

    - использование [атрибутов из нэймспейса][tools] tools: для прототипирования.
Например tools:text, tools:showIn

    - установка дефолтного состояния с данными.

- Не должна требовать дополнительной инициализации (вызова дополнительных
методов кастомной вью в теле активити, фрагмента и тп.) для корректной работы.
Подразумевается, что вью имеет дефолтное состояние.

- Использование в качестве корневого тега merge для уменьшения вложенности
иерархии view. Для корректного отображения в превью проставляется тег
tools:parentTag =(имя класса той вью с которой будет происходить мерж)

- Не устанавливать внешние отступы внутри кастомной вью. На разных экранах
и размерах экрана часто требуются разные отступы. Отступы следует задавать
в той разметке где вью используется.

- Перевод в необходимое состояние происходит через методы `render()` или
`bind()` в зависимости от архитектуры. Вне вью могут быть доступны только листнеры.
**Запрещается взаимодейтсвовать с внутренними свойствами вью напрямую**.


[docs]: https://developer.android.com/guide/topics/ui/custom-components
[ex]: https://gist.github.com/icebail/737f39d6cad140c0a83c4764f5fb0bd8
[presentation]: https://docs.google.com/presentation/d/1_C1fmfLtJYkSzvoa2O3fsUtPrQ7EDr_LIb60pqWU854/edit#slide=id.g114ed9bf1d_0_51
[tools]: https://android.jlelse.eu/tools-attributes-hidden-gems-of-android-studio-d7451b194e0b
